<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"willzhuang.github.io","root":"/","images":"/images","scheme":"Muse","version":"8.3.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}};
  </script>
<meta name="description" content="What is BBS+https:&#x2F;&#x2F;identity.foundation&#x2F;bbs-signature&#x2F;draft-irtf-cfrg-bbs-signatures.htmlThis document describes the BBS Signature scheme, a secure, multi-message digital signature protocol, supportin">
<meta property="og:type" content="article">
<meta property="og:title" content="关于BBS-Signature">
<meta property="og:url" content="https://willzhuang.github.io/2024/05/06/%E5%85%B3%E4%BA%8EBBS-Signature/index.html">
<meta property="og:site_name" content="Zhuang&#39;s Diary">
<meta property="og:description" content="What is BBS+https:&#x2F;&#x2F;identity.foundation&#x2F;bbs-signature&#x2F;draft-irtf-cfrg-bbs-signatures.htmlThis document describes the BBS Signature scheme, a secure, multi-message digital signature protocol, supportin">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2024-05-06T12:46:00.000Z">
<meta property="article:modified_time" content="2024-05-07T07:37:33.281Z">
<meta property="article:author" content="Weiming Zhuang">
<meta property="article:tag" content="DID">
<meta property="article:tag" content="算法">
<meta property="article:tag" content="密码学">
<meta property="article:tag" content="加密">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://willzhuang.github.io/2024/05/06/%E5%85%B3%E4%BA%8EBBS-Signature/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>
<title>关于BBS-Signature | Zhuang's Diary</title>
  




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Zhuang's Diary</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">言之有物，持之以恒</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#What-is-BBS"><span class="nav-number">1.</span> <span class="nav-text">What is BBS+</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Show-me-the-codes"><span class="nav-number">2.</span> <span class="nav-text">Show me the codes</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BBS-%E7%AD%BE%E5%90%8D%E7%9A%84%E9%9B%B6%E7%9F%A5%E8%AF%86%E8%AF%81%E6%98%8E%E7%AE%97%E6%B3%95"><span class="nav-number">3.</span> <span class="nav-text">BBS+签名的零知识证明算法</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Weiming Zhuang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">240</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">60</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://www.linkedin.com/in/zhuangweiming/" title="Linkedin → https:&#x2F;&#x2F;www.linkedin.com&#x2F;in&#x2F;zhuangweiming&#x2F;" rel="noopener" target="_blank"><i class="fab fa-linkedin fa-fw"></i>Linkedin</a>
      </span>
  </div>



        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="Back to top">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://willzhuang.github.io/2024/05/06/%E5%85%B3%E4%BA%8EBBS-Signature/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Weiming Zhuang">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zhuang's Diary">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          关于BBS-Signature
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2024-05-06 20:46:00" itemprop="dateCreated datePublished" datetime="2024-05-06T20:46:00+08:00">2024-05-06</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2024-05-07 15:37:33" itemprop="dateModified" datetime="2024-05-07T15:37:33+08:00">2024-05-07</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h3 id="What-is-BBS"><a href="#What-is-BBS" class="headerlink" title="What is BBS+"></a>What is BBS+</h3><p><a target="_blank" rel="noopener" href="https://identity.foundation/bbs-signature/draft-irtf-cfrg-bbs-signatures.html">https://identity.foundation/bbs-signature/draft-irtf-cfrg-bbs-signatures.html</a><br>This document describes the BBS Signature scheme, a secure, multi-message digital signature protocol, supporting proving knowledge of a signature while selectively disclosing any subset of the signed messages. Concretely, the scheme allows for signing multiple messages whilst producing a single, constant size, digital signature. Additionally, the possessor of a BBS signatures is able to create zero-knowledge, proofs-of-knowledge of a signature, while selectively disclosing subsets of the signed messages. Being zero-knowledge, the BBS proofs do not reveal any information about the undisclosed messages or the signature it self, while at the same time, guarantying the authenticity and integrity of the disclosed messages. This is NOT a production-ready document.</p>
<p>A digital signature scheme is a fundamental cryptographic primitive that is used to provide data integrity and verifiable authenticity in various protocols. The core premise of digital signature technology is built upon asymmetric cryptography where-by the possessor of a private key is able to sign a message, where anyone in possession of the corresponding public key matching that of the private key is able to verify the signature.<br>Beyond the core properties of a digital signature scheme, the BBS signatures and proofs provide multiple additional unique properties. Three key ones are:</p>
<p><strong>Selective Disclosure</strong> - The scheme allows a Signer to sign multiple messages and produce a single -constant size- output signature. A Prover then possessing the messages and the signature can generate a proof whereby they can choose which messages to disclose, while revealing no-information about the undisclosed messages. The proof itself guarantees the integrity and authenticity of the disclosed messages (e.g. that they were originally signed by the Signer).</p>
<p><strong>Unlinkable Proofs</strong> - The proofs generated by the scheme are zero-knowledge, proofs-of-knowledge of the signature, meaning a verifying party in receipt of a proof is unable to determine which signature was used to generate the proof, removing a common source of correlation. In general, each BBS proof is indistinguishable from random even if generated from the same signature.</p>
<p><strong>Proof of Possession</strong> - The proofs generated by the scheme prove to a Verifier that the party who generated the proof (Prover) was in possession of a signature without revealing it. The scheme also supports binding a presentation header to the generated proof. The presentation header can include arbitrary information such as a cryptographic nonce, an audience/domain identifier and or time based validity information.</p>
<p>Below is a basic diagram describing the main entities involved in the scheme.</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"> (1) sign                                      (3) ProofGen</span><br><span class="line">   +-----                                         +-----</span><br><span class="line">   |    |                                         |    |</span><br><span class="line">   |    |                                         |    |</span><br><span class="line">   |   \ /                                        |   \ /</span><br><span class="line">+----------+                                   +-----------+</span><br><span class="line">|          |                                   |           |</span><br><span class="line">|          |                                   |           |</span><br><span class="line">|          |                                   |           |</span><br><span class="line">|  Signer  |---(2)* Send signature + msgs-----&gt;|  Holder/  |</span><br><span class="line">|          |                                   |  Prover   |</span><br><span class="line">|          |                                   |           |</span><br><span class="line">|          |                                   |           |</span><br><span class="line">+----------+                                   +-----------+</span><br><span class="line">                                                     |</span><br><span class="line">                                                     |</span><br><span class="line">                                                     |</span><br><span class="line">                                    (4)* Send proof + disclosed msgs</span><br><span class="line">                                                     |</span><br><span class="line">                                                     |</span><br><span class="line">                                                    \ /</span><br><span class="line">                                               +-----------+</span><br><span class="line">                                               |           |</span><br><span class="line">                                               |           |</span><br><span class="line">                                               |           |</span><br><span class="line">                                               | Verifier  |</span><br><span class="line">                                               |           |</span><br><span class="line">                                               |           |</span><br><span class="line">                                               |           |</span><br><span class="line">                                               +-----------+</span><br><span class="line">                                                  |   / \</span><br><span class="line">                                                  |    |</span><br><span class="line">                                                  |    |</span><br><span class="line">                                                  +-----</span><br><span class="line">                                             (5) ProofVerify</span><br></pre></td></tr></table></figure>
<p>Note that the BBS Signatures scheme is based on the discrete logarithm problem. This means that it is not “post-quantum secure”. However, the privacy and hiding properties of BBS proofs are resilient even against an attacker utilizing a Cryptographically Relevant Quantum Computer</p>
<h3 id="Show-me-the-codes"><a href="#Show-me-the-codes" class="headerlink" title="Show me the codes"></a>Show me the codes</h3><p><a target="_blank" rel="noopener" href="https://github.com/microsoft/bbs-node-reference">https://github.com/microsoft/bbs-node-reference</a><br>the current implementation matches the <em>21 December 2023</em> version of the specification, matching the <a target="_blank" rel="noopener" href="https://datatracker.ietf.org/doc/draft-irtf-cfrg-bbs-signatures/05/">draft-irtf-cfrg-bbs-signatures-05</a> version submitted to the CFRG. This is NOT a production-ready implementation; testing is minimal and no effort is made to optimize and protect against specialized attacks (e.g., side-channel resistance).</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> bbs_1 = <span class="built_in">require</span>(<span class="string">&quot;../src/bbs&quot;</span>);  </span><br><span class="line"><span class="keyword">const</span> crypto = __importStar(<span class="built_in">require</span>(<span class="string">&quot;crypto&quot;</span>));  </span><br><span class="line"><span class="keyword">const</span> utils = __importStar(<span class="built_in">require</span>(<span class="string">&quot;../src/utils&quot;</span>));  </span><br><span class="line"><span class="keyword">const</span> ciphersuite_1 = <span class="built_in">require</span>(<span class="string">&quot;../src/ciphersuite&quot;</span>);  </span><br><span class="line"><span class="keyword">const</span> ciphersuites = [ciphersuite_1.BLS12_381_SHAKE_256_Ciphersuite, ciphersuite_1.BLS12_381_SHA256_Ciphersuite];  </span><br><span class="line">ciphersuites.forEach(<span class="function"><span class="params">cs</span> =&gt;</span> &#123;  </span><br><span class="line">    test(<span class="string">&quot;End-to-end test: &quot;</span> + cs.ciphersuite_id, <span class="keyword">async</span> () =&gt; &#123;  </span><br><span class="line">        <span class="comment">// create the bbs instance  </span></span><br><span class="line">        <span class="keyword">const</span> bbs = <span class="keyword">new</span> bbs_1.BBS(cs);  </span><br><span class="line">        <span class="comment">// generate random issuer keys  </span></span><br><span class="line">        <span class="keyword">const</span> SK = bbs.KeyGen(crypto.randomBytes(<span class="number">32</span>));  </span><br><span class="line">        <span class="keyword">const</span> PK = bbs.SkToPk(SK);  </span><br><span class="line">        <span class="comment">// create the generators, equal to issuer.  </span></span><br><span class="line">        <span class="keyword">const</span> length = <span class="number">5</span>;  </span><br><span class="line">        <span class="keyword">const</span> generators = <span class="keyword">await</span> bbs.create_generators(length);  </span><br><span class="line">        <span class="comment">// create random messages for test.  </span></span><br><span class="line">        <span class="keyword">let</span> msg = <span class="built_in">Array</span>(length).fill(<span class="literal">null</span>).map(<span class="function"><span class="params">v</span> =&gt;</span> bbs.MapMessageToScalarAsHash(crypto.randomBytes(<span class="number">20</span>)));  </span><br><span class="line">        <span class="comment">// create the signature.  </span></span><br><span class="line">        <span class="keyword">const</span> header = Buffer.from(<span class="string">&quot;HEADER&quot;</span>, <span class="string">&quot;utf-8&quot;</span>);  </span><br><span class="line">        <span class="keyword">const</span> signature = bbs.Sign(SK, PK, header, msg, generators);  </span><br><span class="line">        <span class="comment">// validate the signature, should be true.  </span></span><br><span class="line">        bbs.Verify(PK, signature, header, msg, generators);  </span><br><span class="line">        <span class="comment">// randomly disclose each message.  </span></span><br><span class="line">        <span class="keyword">const</span> disclosed_indexes = <span class="built_in">Array</span>(length).fill(<span class="number">0</span>).map(<span class="function">(<span class="params">v, i, a</span>) =&gt;</span> i).filter(<span class="function"><span class="params">v</span> =&gt;</span> &#123; <span class="keyword">return</span> <span class="built_in">Math</span>.random() &gt; <span class="number">0.5</span>; &#125;); <span class="comment">// random coin flip for each message  </span></span><br><span class="line">        <span class="keyword">const</span> ph = Buffer.from(<span class="string">&quot;PRESENTATION HEADER&quot;</span>, <span class="string">&quot;utf-8&quot;</span>);  </span><br><span class="line">        <span class="keyword">const</span> proof = bbs.ProofGen(PK, signature, header, ph, msg, generators, disclosed_indexes);  </span><br><span class="line">        <span class="keyword">const</span> disclosed_msg = utils.filterDisclosedMessages(msg, disclosed_indexes);  </span><br><span class="line">        <span class="comment">// validate the proof, should be true.  </span></span><br><span class="line">        bbs.ProofVerify(PK, proof, header, ph, disclosed_msg, generators, disclosed_indexes);  </span><br><span class="line">    &#125;);  </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="BBS-签名的零知识证明算法"><a href="#BBS-签名的零知识证明算法" class="headerlink" title="BBS+签名的零知识证明算法"></a>BBS+签名的零知识证明算法</h3><p>BBS+签名算法的流程可以分为三个主要部分：系统初始化、密钥生成、签名和验证。<br>BBS+ 与 Zero Knowledge Proof 的结合是其算法的最大特点之一。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">proof = ProofGen(PK, signature, header, ph, messages, disclosed_indexes)</span><br><span class="line"></span><br><span class="line">Inputs:</span><br><span class="line"></span><br><span class="line">- PK (REQUIRED), an octet string <span class="keyword">of</span> the form outputted by the SkToPk operation.</span><br><span class="line">- signature (REQUIRED), an octet string <span class="keyword">of</span> the form outputted by the Sign operation.</span><br><span class="line">- header (OPTIONAL), an octet string containing context and application specific information. If not supplied, it defaults to the empty octet string (<span class="string">&quot;&quot;</span>).</span><br><span class="line">- ph (OPTIONAL), an octet string containing the presentation header. If not supplied, it defaults to the empty octet string (<span class="string">&quot;&quot;</span>).</span><br><span class="line">- messages (OPTIONAL), a vector <span class="keyword">of</span> octet strings. If not supplied, it defaults to the empty array (<span class="string">&quot;()&quot;</span>).</span><br><span class="line">- disclosed_indexes (OPTIONAL), vector <span class="keyword">of</span> unsigned integers <span class="keyword">in</span> ascending order. Indexes <span class="keyword">of</span> disclosed messages. If not supplied, it defaults to the empty array (<span class="string">&quot;()&quot;</span>).</span><br><span class="line"></span><br><span class="line">Parameters:</span><br><span class="line"></span><br><span class="line">- api_id, the octet string ciphersuite_id || <span class="string">&quot;H2G_HM2S_&quot;</span>, where ciphersuite_id is defined by the ciphersuite and <span class="string">&quot;H2G_HM2S_&quot;</span>is an ASCII string comprised <span class="keyword">of</span> <span class="number">9</span> bytes.</span><br><span class="line"></span><br><span class="line">Outputs:</span><br><span class="line"></span><br><span class="line">- proof, an octet string; or INVALID.</span><br><span class="line"></span><br><span class="line">Procedure:</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> message_scalars = messages_to_scalars(messages, api_id)</span><br><span class="line"><span class="number">2.</span> generators = create_generators(length(messages)+<span class="number">1</span>, api_id)</span><br><span class="line"><span class="number">3.</span> proof = CoreProofGen(PK, signature, generators, header, ph,</span><br><span class="line">                             message_scalars, disclosed_indexes, api_id)</span><br><span class="line"><span class="number">4.</span> <span class="keyword">if</span> proof is INVALID, <span class="keyword">return</span> INVALID</span><br><span class="line"><span class="number">5.</span> <span class="keyword">return</span> proof</span><br><span class="line"></span><br><span class="line">&lt;=============================CoreProofGen===================================&gt;</span><br><span class="line"></span><br><span class="line">proof = CoreProofGen(PK, signature, generators, header, ph, messages,</span><br><span class="line">                                              disclosed_indexes, api_id)</span><br><span class="line"></span><br><span class="line">Inputs:</span><br><span class="line"></span><br><span class="line">- PK (REQUIRED), an octet string <span class="keyword">of</span> the form outputted by the SkToPk operation.</span><br><span class="line">- signature (REQUIRED), an octet string <span class="keyword">of</span> the form outputted by the Sign operation.</span><br><span class="line">- generators (REQUIRED), vector <span class="keyword">of</span> pseudo-random points <span class="keyword">in</span> G1.</span><br><span class="line">- header (OPTIONAL), an octet string containing context and application specific information. If not supplied, it defaults to the empty octet string (<span class="string">&quot;&quot;</span>).</span><br><span class="line">- ph (OPTIONAL), an octet string containing the presentation header. If not supplied, it defaults to the empty octet string (<span class="string">&quot;&quot;</span>).</span><br><span class="line">- messages (OPTIONAL), a vector <span class="keyword">of</span> scalars representing the messages. If not supplied, it defaults to the empty array (<span class="string">&quot;()&quot;</span>).</span><br><span class="line">- disclosed_indexes (OPTIONAL), vector <span class="keyword">of</span> non-negative integers <span class="keyword">in</span> ascending order. Indexes <span class="keyword">of</span> disclosed messages. If not supplied, it defaults to the empty array (<span class="string">&quot;()&quot;</span>).</span><br><span class="line">- api_id (OPTIONAL), an octet string. If not supplied it defaults to the empty octet string (<span class="string">&quot;&quot;</span>).</span><br><span class="line"></span><br><span class="line">Outputs:</span><br><span class="line"></span><br><span class="line">- proof, an octet string; or INVALID.</span><br><span class="line"></span><br><span class="line">Deserialization:</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>  signature_result = octets_to_signature(signature)</span><br><span class="line"><span class="number">2.</span>  <span class="keyword">if</span> signature_result is INVALID, <span class="keyword">return</span> INVALID</span><br><span class="line"><span class="number">3.</span>  (A, e) = signature_result</span><br><span class="line"><span class="number">4.</span>  L = length(messages)</span><br><span class="line"><span class="number">5.</span>  R = length(disclosed_indexes)</span><br><span class="line"><span class="number">6.</span>  <span class="keyword">if</span> R &gt; L, <span class="keyword">return</span> INVALID</span><br><span class="line"><span class="number">7.</span>  U = L - R</span><br><span class="line"><span class="number">8.</span>  <span class="keyword">for</span> i <span class="keyword">in</span> disclosed_indexes, <span class="keyword">if</span> i &lt; <span class="number">0</span> or i &gt; L - <span class="number">1</span>, <span class="keyword">return</span> INVALID</span><br><span class="line"><span class="number">9.</span>  undisclosed_indexes = (<span class="number">0</span>, <span class="number">1</span>, ..., L - <span class="number">1</span>) \ disclosed_indexes</span><br><span class="line"><span class="number">10.</span> (i1, ..., iR) = disclosed_indexes</span><br><span class="line"><span class="number">11.</span> (j1, ..., jU) = undisclosed_indexes</span><br><span class="line"><span class="number">12.</span> disclosed_messages = (messages[i1], ..., messages[iR])</span><br><span class="line"><span class="number">13.</span> undisclosed_messages = (messages[j1], ..., messages[jU])</span><br><span class="line"></span><br><span class="line">Procedure:</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> random_scalars = calculate_random_scalars(<span class="number">5</span>+U)</span><br><span class="line"><span class="number">2.</span> init_res = ProofInit(PK,</span><br><span class="line">                        signature_result,</span><br><span class="line">                        generators,</span><br><span class="line">                        random_scalars,</span><br><span class="line">                        header,</span><br><span class="line">                        messages,</span><br><span class="line">                        undisclosed_indexes,</span><br><span class="line">                        api_id)</span><br><span class="line"><span class="number">3.</span> <span class="keyword">if</span> init_res is INVALID, <span class="keyword">return</span> INVALID</span><br><span class="line"><span class="number">4.</span> challenge = ProofChallengeCalculate(init_res, disclosed_indexes,</span><br><span class="line">                                                 disclosed_messages, ph)</span><br><span class="line"><span class="number">5.</span> <span class="keyword">if</span> challenge is INVALID, <span class="keyword">return</span> INVALID</span><br><span class="line"><span class="number">6.</span> proof = ProofFinalize(init_res, challenge, e, random_scalars,</span><br><span class="line">                                                   undisclosed_messages)</span><br><span class="line"><span class="number">7.</span> <span class="keyword">return</span> proof</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">result = ProofVerify(PK, proof, header, ph, disclosed_messages, disclosed_indexes)</span><br><span class="line"></span><br><span class="line">Inputs:</span><br><span class="line"></span><br><span class="line">- PK (REQUIRED), an octet string <span class="keyword">of</span> the form outputted by the SkToPk operation.</span><br><span class="line">- proof (REQUIRED), an octet string <span class="keyword">of</span> the form outputted by the ProofGen operation.</span><br><span class="line">- header (OPTIONAL), an optional octet string containing context and application specific information. If not supplied, it defaults to the empty octet string (<span class="string">&quot;&quot;</span>).</span><br><span class="line">- ph (OPTIONAL), an octet string containing the presentation header. If not supplied, it defaults to the empty octet string (<span class="string">&quot;&quot;</span>).</span><br><span class="line">- disclosed_messages (OPTIONAL), a vector <span class="keyword">of</span> octet strings. If not supplied, it defaults to the empty array (<span class="string">&quot;()&quot;</span>).</span><br><span class="line">- disclosed_indexes (OPTIONAL), vector <span class="keyword">of</span> unsigned integers <span class="keyword">in</span> ascending order. Indexes <span class="keyword">of</span> disclosed messages. If not supplied, it defaults to the empty array (<span class="string">&quot;()&quot;</span>).</span><br><span class="line"></span><br><span class="line">Parameters:</span><br><span class="line"></span><br><span class="line">- api_id, the octet string ciphersuite_id || <span class="string">&quot;H2G_HM2S_&quot;</span>, where</span><br><span class="line">          ciphersuite_id is defined by the ciphersuite and <span class="string">&quot;H2G_HM2S_&quot;</span>is</span><br><span class="line">          an ASCII string comprised <span class="keyword">of</span> <span class="number">9</span> bytes.</span><br><span class="line">- (octet_point_length, octet_scalar_length), defined by the ciphersuite.</span><br><span class="line"></span><br><span class="line">Outputs:</span><br><span class="line"></span><br><span class="line">- result, either VALID or INVALID.</span><br><span class="line"></span><br><span class="line">Deserialization:</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> proof_len_floor = <span class="number">2</span> * octet_point_length + <span class="number">3</span> * octet_scalar_length</span><br><span class="line"><span class="number">2.</span> <span class="keyword">if</span> length(proof) &lt; proof_len_floor, <span class="keyword">return</span> INVALID</span><br><span class="line"><span class="number">3.</span> U = floor((length(proof) - proof_len_floor) / octet_scalar_length)</span><br><span class="line"><span class="number">4.</span> R = length(disclosed_indexes)</span><br><span class="line"></span><br><span class="line">Procedure:</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> message_scalars = messages_to_scalars(disclosed_messages, api_id)</span><br><span class="line"><span class="number">2.</span> generators = create_generators(U + R + <span class="number">1</span>, api_id)</span><br><span class="line"><span class="number">3.</span> result = CoreProofVerify(PK, proof, generators, header, ph,</span><br><span class="line">                             message_scalars, disclosed_indexes, api_id)</span><br><span class="line"><span class="number">4.</span> <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">&lt;============================CoreProofVerify=============================&gt;</span><br><span class="line"></span><br><span class="line">result = CoreProofVerify(PK, proof, generators, header, ph,</span><br><span class="line">                          disclosed_messages, disclosed_indexes, api_id)</span><br><span class="line"></span><br><span class="line">Inputs:</span><br><span class="line"></span><br><span class="line">- PK (REQUIRED), an octet string <span class="keyword">of</span> the form outputted by the SkToPk operation.</span><br><span class="line">- proof (REQUIRED), an octet string <span class="keyword">of</span> the form outputted by the ProofGen operation.</span><br><span class="line">- generators (REQUIRED), vector <span class="keyword">of</span> pseudo-random points <span class="keyword">in</span> G1.</span><br><span class="line">- header (OPTIONAL), an optional octet string containing context and application specific information. If not supplied, it defaults to the empty octet string (<span class="string">&quot;&quot;</span>).</span><br><span class="line">- ph (OPTIONAL), an octet string containing the presentation header. If not supplied, it defaults to the empty octet string (<span class="string">&quot;&quot;</span>).</span><br><span class="line">- disclosed_messages (OPTIONAL), a vector <span class="keyword">of</span> scalars representing the messages. If not supplied, it defaults to the empty array (<span class="string">&quot;()&quot;</span>).</span><br><span class="line">- disclosed_indexes (OPTIONAL), vector <span class="keyword">of</span> non-negative integers <span class="keyword">in</span> ascending order. Indexes <span class="keyword">of</span> disclosed messages. If not supplied, it defaults to the empty array (<span class="string">&quot;()&quot;</span>).</span><br><span class="line">- api_id (OPTIONAL), an octet string. If not supplied it defaults to the empty octet string (<span class="string">&quot;&quot;</span>).</span><br><span class="line"></span><br><span class="line">Parameters:</span><br><span class="line"></span><br><span class="line">- P1, fixed point <span class="keyword">of</span> G1, defined by the ciphersuite.</span><br><span class="line"></span><br><span class="line">Outputs:</span><br><span class="line"></span><br><span class="line">- result, either VALID or INVALID.</span><br><span class="line"></span><br><span class="line">Deserialization:</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> proof_result = octets_to_proof(proof)</span><br><span class="line"><span class="number">2.</span> <span class="keyword">if</span> proof_result is INVALID, <span class="keyword">return</span> INVALID</span><br><span class="line"><span class="number">3.</span> (Abar, Bbar, D, e^, r1^, r3^, commitments, cp) = proof_result</span><br><span class="line"><span class="number">4.</span> W = octets_to_pubkey(PK)</span><br><span class="line"><span class="number">5.</span> <span class="keyword">if</span> W is INVALID, <span class="keyword">return</span> INVALID</span><br><span class="line"></span><br><span class="line">Procedure:</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span> init_res = ProofVerifyInit(PK, proof_result, generators, header,</span><br><span class="line">                                    messages, disclosed_indexes, api_id)</span><br><span class="line"><span class="number">2.</span> <span class="keyword">if</span> init_res is INVALID, <span class="keyword">return</span> INVALID</span><br><span class="line"><span class="number">3.</span> challenge = ProofChallengeCalculate(init_res, disclosed_indexes,</span><br><span class="line">                                                   messages, ph, api_id)</span><br><span class="line"><span class="number">4.</span> <span class="keyword">if</span> challenge is INVALID, <span class="keyword">return</span> INVALID</span><br><span class="line"><span class="number">5.</span> <span class="keyword">if</span> cp != challenge, <span class="keyword">return</span> INVALID</span><br><span class="line"><span class="number">6.</span> <span class="keyword">if</span> e(Abar, W) * e(Bbar, -BP2) != Identity_GT, <span class="keyword">return</span> INVALID</span><br><span class="line"><span class="number">7.</span> <span class="keyword">return</span> VALID</span><br></pre></td></tr></table></figure>
    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>Weiming Zhuang
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://willzhuang.github.io/2024/05/06/%E5%85%B3%E4%BA%8EBBS-Signature/" title="关于BBS-Signature">https://willzhuang.github.io/2024/05/06/关于BBS-Signature/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> unless stating additionally.
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/DID/" rel="tag"># DID</a>
              <a href="/tags/%E7%AE%97%E6%B3%95/" rel="tag"># 算法</a>
              <a href="/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/" rel="tag"># 密码学</a>
              <a href="/tags/%E5%8A%A0%E5%AF%86/" rel="tag"># 加密</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2024/05/06/BIS-Innovation-Summit-2024/" rel="prev" title="BIS-Innovation-Summit-2024">
                  <i class="fa fa-chevron-left"></i> BIS-Innovation-Summit-2024
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Weiming Zhuang</span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  
<script src="/js/local-search.js"></script>






  




  <script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'none'
      },
      options: {
        renderActions: {
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              const target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js';
    script.defer = true;
    document.head.appendChild(script);
  } else {
    MathJax.startup.document.state(0);
    MathJax.typesetClear();
    MathJax.texReset();
    MathJax.typeset();
  }
</script>



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css">

<script>
NexT.utils.loadComments('.gitalk-container', () => {
  NexT.utils.getScript('https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : 'bcfbeadd6147f39af62f',
      clientSecret: '36f4ca5368918536f72f6b3816b90c30f61effb3',
      repo        : 'willzhuang.github.io',
      owner       : 'WillZhuang',
      admin       : ['WillZhuang'],
      id          : '13db84b888828f3f0a60a0593ec82c2c',
      proxy       : 'https://cors-anywhere.herokuapp.com/https://github.com/login/oauth/access_token',
        language: 'zh-CN',
      distractionFreeMode: true
    });
    gitalk.render(document.querySelector('.gitalk-container'));
  }, window.Gitalk);
});
</script>

</body>
</html>
